<!DOCTYPE html>
<html>
  <head>
    <title>pv - JavaScript protein viewer</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <script src='js/jquery-2.0.2.min.js'></script>
    <script src='js/gl-matrix.js'></script>
    <script src='js/structure.js'></script>
    <style>
    body {
      font-family: Monospace;
      background-color: #fff;/*#f0f0f0;*/
      margin: 0px;
      overflow: hidden;
    }
    </style>
    </head>
<body>
  <div id=gl>
  </div>
  <script type='x-shader/x-fragment' id='shader-fs'>
    precision mediump float;

    varying vec3 vert_color;
    varying vec3 vert_normal;

    void main(void) {
      gl_FragColor = mix(vec4(vert_color, 1.0), vec4(0.2, 0.2, 0.2, 1.0), 
                         max(0.0, dot(vert_normal, vec3(1.0, 0.0, 0.0))));
    }

  </script>
  <script type='x-shader/x-vertex' id='shader-vs'>
    attribute vec3 attr_pos;
    attribute vec3 attr_color;
    attribute vec3 attr_normal;

    uniform mat4 projection_mat;
    uniform mat4 modelview_mat;
    varying vec3 vert_color;
    varying vec3 vert_normal;
    void main(void) {
      gl_Position = projection_mat * modelview_mat * vec4(attr_pos, 1.0);
      vert_normal = vec3(modelview_mat * vec4(attr_normal, 0.0));
      vert_color = attr_color;
    }
  </script>
  <script>
    var pv = PV(document.getElementById('gl'));

   
    function on_ready() {
      $.ajax({ url : 'pdbs/1ake.pdb', success : function(data) {
        var structure = load_pdb(data);
        pv.add(structure.sline());
        //pv.add(structure.line_trace());
        pv.center_on(structure);
        pv.draw();
      }});
    }
    document.addEventListener('DOMContentLoaded', on_ready);
  </script>
</body>
</html>
